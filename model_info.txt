# MODEL INFORMATION FILE
## House Price Prediction Model Documentation

### Overview
This file describes the machine learning model saved as "model.pkl" (pickle file). This model predicts median house values in California based on various housing and demographic features.

---

## Model Type
**Algorithm:** Random Forest Regressor
- A Random Forest is an ensemble learning method that creates multiple decision trees and combines their predictions
- It works by building many decision trees during training and outputting the average prediction of all trees
- Number of trees (n_estimators): 100
- Random state: 42 (for reproducibility)

---

## Dataset Information
**Source:** California Housing Dataset from Aurélien Géron's "Hands-On Machine Learning" GitHub repository
**URL:** https://raw.githubusercontent.com/ageron/handson-ml2/master/datasets/housing/housing.csv

**Target Variable:** median_house_value (the price we're trying to predict)

**Training Split:**
- 80% of data used for training
- 20% of data used for testing
- Random state: 42

---

## Input Features (9 total)

### Numeric Features (8):
1. **longitude** - Geographic coordinate (west-east position)
2. **latitude** - Geographic coordinate (north-south position)
3. **housing_median_age** - Median age of houses in the block
4. **total_rooms** - Total number of rooms in the block
5. **total_bedrooms** - Total number of bedrooms in the block
6. **population** - Total population in the block
7. **households** - Total number of households in the block
8. **median_income** - Median income of households (in tens of thousands of dollars)

### Categorical Features (1):
9. **ocean_proximity** - Proximity to ocean (text values like "NEAR BAY", "INLAND", "NEAR OCEAN", etc.)

---

## Preprocessing Pipeline
The model.pkl file contains a complete preprocessing pipeline that automatically transforms raw input data before making predictions.

### For Numeric Features:
- **Imputation:** Missing values are filled with the median value of that feature
- **No scaling applied** - Random Forest doesn't require feature scaling

### For Categorical Features:
- **Imputation:** Missing values are filled with the word "missing"
- **One-Hot Encoding:** Converts text categories into numeric binary columns
- **Handle unknown:** If a new category appears that wasn't in training, it's safely ignored

---

## Model Structure
The model.pkl file is a scikit-learn Pipeline object containing:

1. **Preprocessor (ColumnTransformer)**
   - Numeric transformer for 8 numeric features
   - Categorical transformer for 1 categorical feature

2. **Regressor (RandomForestRegressor)**
   - 100 decision trees
   - Trained on preprocessed data

---

## Model Performance Metrics
After training on the California Housing dataset:

- **R2 Score:** Measures how well the model explains variance in house prices (ranges from 0 to 1, higher is better)
- **Mean Squared Error (MSE):** Measures average squared difference between predicted and actual prices (lower is better)

Note: Exact values depend on the training run but typically achieve R2 score above 0.80

---

## Input Format Expected
When making predictions, the model expects a pandas DataFrame with these exact column names:

```
{
    'longitude': float value (e.g., -122.23),
    'latitude': float value (e.g., 37.88),
    'housing_median_age': float value (e.g., 41.0),
    'total_rooms': float value (e.g., 880.0),
    'total_bedrooms': float value (e.g., 129.0),
    'population': float value (e.g., 322.0),
    'households': float value (e.g., 126.0),
    'median_income': float value (e.g., 8.3252),
    'ocean_proximity': string value (e.g., 'NEAR BAY')
}
```

---

## Output Format
The model outputs a single numeric value representing the predicted median house value in dollars.

Example: 452600.50 (meaning four hundred fifty-two thousand six hundred dollars and fifty cents)

---

## How the Model is Used in app.py

1. **Loading:** The model is loaded using joblib.load('model.pkl') when the Flask application starts
2. **Input Processing:** User form data is converted into a pandas DataFrame with the correct column names
3. **Prediction:** The model.predict() method is called, which automatically:
   - Runs the preprocessing pipeline
   - Makes a prediction using the Random Forest
4. **Output:** Returns a single predicted house value

---

## Libraries Used
- **pandas:** Data manipulation and DataFrame creation
- **scikit-learn:** Machine learning pipeline, preprocessing, and Random Forest algorithm
- **joblib:** Saving and loading the trained model pipeline
- **numpy:** Numerical operations (used by scikit-learn)

---

## Key Advantages of This Approach

1. **Single File Deployment:** Everything (preprocessing + model) is in one pickle file
2. **Automatic Preprocessing:** No need to manually scale or encode data when making predictions
3. **Robust to Missing Data:** Imputation handles missing values gracefully
4. **Handles New Categories:** OneHotEncoder with handle_unknown='ignore' prevents errors
5. **No Feature Scaling Needed:** Random Forest works well without normalization

---

## Technical Notes

- The model file size depends on the number of trees and dataset size (typically a few megabytes)
- Random Forest is an ensemble method that's robust to outliers and doesn't require feature scaling
- The pipeline ensures that test/production data receives identical preprocessing as training data
- The model is deterministic (same inputs always produce same outputs) due to random_state=42

---

End of model documentation.